{% extends "flashcards_app/base_flashcards_app.html" %}
{% block content %}
{% load ui_tags %}

<!-- Main Content with Decks -->
<div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
    <div class="flex justify-between items-center mb-6">
        <h1 class="text-3xl font-bold text-white">My Decks</h1>
        <a href="{% url 'collection-create' %}"
           class="flex items-center text-lg font-bold text-gray-300 hover:text-[#7D5FFF] transition">
            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none"
                 stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
                 class="lucide lucide-plus mr-1">
                <path d="M12 5v14"/>
                <path d="M5 12h14"/>
            </svg>
            New Collection
        </a>
    </div>

    <!-- Decks Grid -->
    <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6" id="deck-cards-container">
        {% for deck in decks %}

        <!-- Deck Card -->
        <div class="relative group bg-white/10 backdrop-blur-md rounded-3xl
                    shadow-xl shadow-purple-900/40 hover:shadow-cyan-500/40
                    transform hover:-translate-y-2 transition-all duration-300
                    p-8 flex flex-col justify-between items-start border border-white/10 hover:border-cyan-400"
                    x-data="{ open: false, modeOpen: false }" :class="{ 'z-20': open || modeOpen }">
            <div>
                <h2 class="text-2xl font-extrabold text-white mb-2 tracking-wide">{{ deck.name }}</h2>
                <p class="text-cyan-200 mb-1 text-sm">Cards: {{ deck.cards.count }}</p>
                <p class="text-indigo-200 text-sm mt-2 line-clamp-3 overflow-hidden text-ellipsis h-15">
                    {{ deck.description }}
                </p>
            </div>

            <!-- Study and Options Buttons -->
            <div class="flex justify-between items-center w-full mt-6">

                <!-- Study Mode Button -->
                <div class="relative w-full max-w-[200px]">
                    <button @click="modeOpen = !modeOpen"
                            class="inline-flex items-center justify-between w-full px-5 py-2
                                   bg-white/15 hover:bg-white/25 text-white font-semibold rounded-full
                                   transition-colors duration-200 shadow-lg hover:shadow-xl"
                            :class="{'outline-none ring-2 ring-cyan-500': modeOpen}">
                        <span class="inline-flex items-center">
                            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20"
                                 viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                 stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
                                 class="lucide lucide-book-open mr-2">
                                <path d="M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z"/>
                                <path d="M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 0 3 3h7z"/>
                            </svg>
                            Study Mode
                        </span>
                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16"
                             viewBox="0 0 24 24" fill="none" stroke="currentColor"
                             stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
                             class="ml-2 lucide lucide-chevron-down">
                            <path d="M6 9l6 6 6-6"/>
                        </svg>
                    </button>

                    <!-- Study Mode Dropdown -->
                    <div x-show="modeOpen" @click.away="modeOpen = false" x-transition
                         class="right-0 mt-2 {% dropdown_menu %}">
                        <a href="{% url 'card-list' pk=collection.pk deck_pk=deck.pk %}"
                           class="{% btn_dropdown_primary %}">
                            <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18"
                                 viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                 stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
                                 class="lucide lucide-check-circle mr-2">
                                <circle cx="12" cy="12" r="10"/>
                                <path d="M9 12l2 2 4-4"/>
                            </svg>
                            Normal
                        </a>
                        <a href="{% url 'card-reverse_list' pk=collection.pk deck_pk=deck.pk %}"
                           class="{% btn_dropdown_primary %}">
                            <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18"
                                 viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                 stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
                                 class="lucide lucide-refresh-ccw mr-2">
                                <path d="M21 2v6h-6"/>
                                <path d="M3 12a9 9 0 0 1 9-9 9 9 0 0 1 9 9c0 4.5-3 8-7 9"/>
                                <path d="M3 22v-6h6"/>
                            </svg>
                            Reverse
                        </a>
                        <a href="#"
                           class="{% btn_dropdown_primary %}">
                            <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18"
                                 viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                 stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
                                 class="lucide lucide-edit-3 mr-2">
                                <path d="M12 20h9"/>
                                <path d="M16.5 3.5a2.121 2.121 0 0 1 3 3L7 19l-4 1 1-4Z"/>
                            </svg>
                            Testing
                        </a>
                    </div>
                </div>

                <!-- Options Menu -->
                <div class="relative z-10">
                    <button @click="open = !open"
                            class="ml-1 p-2 rounded-full text-indigo-200 hover:text-white
                                   bg-white/10 hover:bg-white/20 transition-colors duration-200"
                            :class="{'outline-none ring-2 ring-[#7D5FFF]/80 shadow-2xl shadow-[#7D5FFF]/50': open}">
                        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24"
                             viewBox="0 0 24 24" fill="none" stroke="currentColor"
                             stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
                             class="lucide lucide-more-vertical">
                            <circle cx="12" cy="12" r="1"/>
                            <circle cx="12" cy="5" r="1"/>
                            <circle cx="12" cy="19" r="1"/>
                        </svg>
                    </button>

                    <!-- Options Dropdown -->
                    <div x-show="open" @click.away="open = false" x-transition
                         class="right-0 mt-5 {% dropdown_menu %}">
                        <a href="{% url 'card-create' pk=collection.pk deck_pk=deck.pk %}"
                           class="{% btn_dropdown_primary %}">
                            <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18"
                                 viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                 stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
                                 class="lucide lucide-plus-circle mr-2">
                                <circle cx="12" cy="12" r="10"/>
                                <path d="M8 12h8"/>
                                <path d="M12 8v8"/>
                            </svg>
                            Add Cards
                        </a>
                        <a href="{% url 'deck-update' pk=collection.pk deck_pk=deck.pk %}"
                           class="{% btn_dropdown_primary %}">
                            <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18"
                                 viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                 stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
                                 class="lucide lucide-edit mr-2">
                                <path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"/>
                                <path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4Z"/>
                                <line x1="16.5" x2="19.5" y1="6.5" y2="9.5"/>
                            </svg>
                            Edit Deck
                        </a>
                        <a href="{% url 'deck-delete' pk=collection.pk deck_pk=deck.pk %}"
                           class="{% btn_dropdown_danger %}">
                            <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18"
                                 viewBox="0 0 24 24" fill="none" stroke="currentColor"
                                 stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
                                 class="lucide lucide-trash-2 mr-2">
                                <path d="M3 6h18"/>
                                <path d="M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6"/>
                                <path d="M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2"/>
                                <line x1="10" x2="10" y1="11" y2="17"/>
                                <line x1="14" x2="14" y1="11" y2="17"/>
                            </svg>
                            Delete Deck
                        </a>
                    </div>
                </div>
            </div>

        </div>
        {% endfor %}
    </div>
</div>

{% endblock %}
